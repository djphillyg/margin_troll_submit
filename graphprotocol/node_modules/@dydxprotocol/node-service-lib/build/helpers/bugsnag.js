'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.BugsnagTransport = undefined;

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; /* eslint no-console: 0 */


var _winstonTransport = require('winston-transport');

var _winstonTransport2 = _interopRequireDefault(_winstonTransport);

var _bugsnag = require('bugsnag');

var _bugsnag2 = _interopRequireDefault(_bugsnag);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

_bugsnag2.default.register(process.env.BUGSNAG_KEY);

exports.default = _bugsnag2.default;
class BugsnagTransport extends _winstonTransport2.default {
  log(info, callback) {
    setImmediate(() => {
      _bugsnag2.default.notify(info && info.error || new Error(info && info.message), _extends({}, info));
    });
    if (callback) {
      callback();
    }
  }
}
exports.BugsnagTransport = BugsnagTransport;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9oZWxwZXJzL2J1Z3NuYWcuanMiXSwibmFtZXMiOlsiYnVnc25hZyIsInJlZ2lzdGVyIiwicHJvY2VzcyIsImVudiIsIkJVR1NOQUdfS0VZIiwiQnVnc25hZ1RyYW5zcG9ydCIsIlRyYW5zcG9ydCIsImxvZyIsImluZm8iLCJjYWxsYmFjayIsInNldEltbWVkaWF0ZSIsIm5vdGlmeSIsImVycm9yIiwiRXJyb3IiLCJtZXNzYWdlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O2tRQUFBOzs7QUFDQTs7OztBQUNBOzs7Ozs7QUFFQUEsa0JBQVFDLFFBQVIsQ0FBaUJDLFFBQVFDLEdBQVIsQ0FBWUMsV0FBN0I7O2tCQUVlSixpQjtBQUVSLE1BQU1LLGdCQUFOLFNBQStCQywwQkFBL0IsQ0FBeUM7QUFDOUNDLE1BQUlDLElBQUosRUFBVUMsUUFBVixFQUFvQjtBQUNsQkMsaUJBQWEsTUFBTTtBQUNqQlYsd0JBQVFXLE1BQVIsQ0FDR0gsUUFBUUEsS0FBS0ksS0FBZCxJQUF3QixJQUFJQyxLQUFKLENBQVVMLFFBQVFBLEtBQUtNLE9BQXZCLENBRDFCLGVBR09OLElBSFA7QUFNRCxLQVBEO0FBUUEsUUFBSUMsUUFBSixFQUFjO0FBQ1pBO0FBQ0Q7QUFDRjtBQWI2QztRQUFuQ0osZ0IsR0FBQUEsZ0IiLCJmaWxlIjoiYnVnc25hZy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludCBuby1jb25zb2xlOiAwICovXG5pbXBvcnQgVHJhbnNwb3J0IGZyb20gJ3dpbnN0b24tdHJhbnNwb3J0JztcbmltcG9ydCBidWdzbmFnIGZyb20gJ2J1Z3NuYWcnO1xuXG5idWdzbmFnLnJlZ2lzdGVyKHByb2Nlc3MuZW52LkJVR1NOQUdfS0VZKTtcblxuZXhwb3J0IGRlZmF1bHQgYnVnc25hZztcblxuZXhwb3J0IGNsYXNzIEJ1Z3NuYWdUcmFuc3BvcnQgZXh0ZW5kcyBUcmFuc3BvcnQge1xuICBsb2coaW5mbywgY2FsbGJhY2spIHtcbiAgICBzZXRJbW1lZGlhdGUoKCkgPT4ge1xuICAgICAgYnVnc25hZy5ub3RpZnkoXG4gICAgICAgIChpbmZvICYmIGluZm8uZXJyb3IpIHx8IG5ldyBFcnJvcihpbmZvICYmIGluZm8ubWVzc2FnZSksXG4gICAgICAgIHtcbiAgICAgICAgICAuLi5pbmZvLFxuICAgICAgICB9LFxuICAgICAgKTtcbiAgICB9KTtcbiAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgIGNhbGxiYWNrKCk7XG4gICAgfVxuICB9XG59XG4iXX0=