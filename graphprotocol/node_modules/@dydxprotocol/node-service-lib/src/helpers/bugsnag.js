/* eslint no-console: 0 */
import Transport from 'winston-transport';
import bugsnag from 'bugsnag';

bugsnag.register(process.env.BUGSNAG_KEY);

export default bugsnag;

export class BugsnagTransport extends Transport {
  log(info, callback) {
    setImmediate(() => {
      bugsnag.notify(
        (info && info.error) || new Error(info && info.message),
        {
          ...info,
        },
      );
    });
    if (callback) {
      callback();
    }
  }
}
